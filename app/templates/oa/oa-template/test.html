<header data-am-widget="header" class="am-header am-header-default">
    <div class="am-header-left am-header-nav jumpgo">
        <a><img class="am-header-icon-custom" src="data:image/svg+xml;charset=utf-8,&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 0 12 20&quot;&gt;&lt;path d=&quot;M10,0l2,2l-8,8l8,8l-2,2L0,10L10,0z&quot; fill=&quot;%23fff&quot;/&gt;&lt;/svg&gt;" alt=""/></a>
    </div>
    <h1 class="am-header-title">
        我的工作
    </h1>
</header>
<link rel="stylesheet" href="styles/mx.min.css" />
<style>

	.mx-body{
		margin-top: .7em;
		padding: 0 0 1.2rem;
	}
	.mx-media-box__title{
		font-size: 16px;
		margin-bottom: 5px;
	}
	.mx-media-box__desc{
		font-size: 12px;
	}
	.mx-cells__title{
		margin-bottom: 0em;
		margin-top: .3em;
		font-size: 12px;
	}
	.mx-cell{
		padding: 0.6rem 1.5rem;
	}
	.mx-sp{
		color: #333;
	}
	.mx-ft{
		background-color: #f8f8f8;
		padding: 1.5rem;
	}
	.mx-cells{
		margin-top: 0;
	}
	.mx-cell__ft{
		font-size: 12px;
	}
	.mx-br-t{
		border-top: none;
	}
	.mx-mr-t{
		margin-top: 1rem;
	}
	.mx-font-14{
		font-size: 14px;
		color: #1a85ff;
	}
	.mx-col{
		color: #333;
	}
	.mx-btn_mini{
		padding: 0px 2rem;
		margin-top: .8rem;
	}
	.mx-btn_default{
		border-bottom: 1px solid #d9d9d9;
	}
	.mx-text-c{
		text-align: center;
	}
	.mx-alert{
		position: absolute;
		top: 40%;
		left: 50%;
		-webkit-transform: translate(-50%,-40%);
		background: #fff;
		width: 60%;
		height: auto;
		border-radius: 8px;
		font-size: 14px;
		/*display: none;*/
	}
	.approval{
		padding: 10px 0;
	}
	.mx-alert .btn{
		padding: 10px 0;
	}
	.mx-alert .btn button{
		padding: 0 1rem;
		font-size: 1.4rem;
	}
	.mx-mask{
		display: none;
	}
	.mx-mg-t60{
		margin-top: 6.5rem;
	}
	.mx-mg-l{
		margin-left: .5rem;
		border: 1px solid #d9d9d9;
	}
	
</style>
<div class="mx-panel__bd" style="margin-top: 4.8rem;">
	<div class="mx-media-box mx-media-box_appmsg mx-mg-t60 mx-an">
	        <div class="mx-media-box__hd" >
	            <img src="images/1.jpg">
	        </div>
	        <div class="mx-media-box__bd">
	            <h4 class="mx-media-box__title" id="head_name">王震</h4>
	            <p class="mx-media-box__desc" style="margin-top: .5rem;">开发部</p>
	             <!-- <time class="mx-media-box__desc">时间：09-13 08:52</time> -->
	        </div>
	        <button class="mx-btn mx-btn_mini mx-btn_plain-disabled">待审批</button>
	        <!-- <a href="#" class="mx-btn mx-btn_mini mx-btn_primary">下载</a> -->
	</div>
</div>
<div class="mx-body">
	<p class="mx-cells__title">请假类型：<span class="mx-sp">年假</span></p>
	<p class="mx-cells__title">开始时间: <span class="mx-sp">2017-2-11 13:13</span></p>
	<p class="mx-cells__title">结束时间: <span class="mx-sp">2017-2-26 14:10</span></p>
	<p class="mx-cells__title">请假天数: <span class="mx-sp">15天</span></p>
	<p class="mx-cells__title">请假事由: <span class="mx-sp">年假</span></p>
</div>
<div class="mx-ft">
	<div class="mx-cells mx-br-t">
            <div class="mx-cell">
                <div class="mx-cell__bd keys">
                    <!-- <p class="mx-font-14 " id="name"></p> -->
                    <p data-id="" href="#" class="mx-font-14">王震</p>
                </div>
                <div class="mx-cell__ft">13:13</div>
            </div>
        </div>
        <div class="mx-cells">
            <div class="mx-cell">
                <div class="mx-cell__bd">
                    <p class="mx-font-14 mx-col">发起请假申请</p>
                </div>
            </div>
        </div>
		<div class="mx-cells mx-br-t mx-mr-t">
            <div class="mx-cell">
                <div class="mx-cell__bd keys">
                    <!-- <p class="mx-font-14 "><a data-id="" href="#" class="am-icon-comment">&nbsp;</a><span class="mx-cell__ft">副总裁</span></p> -->
                    <p data-id="" href="#" class="mx-font-14">刘磊</p>
                </div>
            </div>
        </div>
        <div class="mx-cells">
            <div class="mx-cell">
                <div class="mx-cell__bd">
                    <p class="mx-font-14 mx-col">待审批</p>
                </div>
            </div>
        </div>
        <div class="mx-cells mx-br-t mx-mr-t">
            <div class="mx-cell">
                <div class="mx-cell__bd keys">
                    <!-- <p class="mx-font-14"> <span class="mx-cell__ft">总裁</span></p> -->
                    <p data-id="" href="#" class="mx-font-14">于浩</p>
                </div>
            </div>
        </div>
        <div class="mx-cells">
            <div class="mx-cell">
                <div class="mx-cell__bd">
                    <p class="mx-font-14 mx-col">待审批</p>
                </div>
            </div>
        </div>
        <div class="mx-text-c">
        	  <a href="javascript:;" class="mx-btn mx-btn_default mx-btn_mini mx-mg-l" id="commit">提交</a>
	          <a href="javascript:;" class="mx-btn mx-btn_default mx-btn_mini mx-mg-l">转发</a>
	          <a href="javascript:;" class="mx-btn mx-btn_default mx-btn_mini mx-mg-l" id="approval">同意</a>
	          <div class="mx-mask" id="mx-mask">
                    <div class="mx-alert" style="z-index: 99">
                    	<p class="approval">您确定要同意吗？</p>
                    	<div class="btn">
                    		<button id="yes">确定</button>
                    		<button id="no">取消</button>
                    	</div>
                    </div>
                </div>
        </div>
</div>
<script>
	$(function(){
		console.log(window.location.hash)
		var hash = window.location.hash;
		var id = hash.split('=')[1];
		console.log('id:::', id);
	})
	$('#approval').click(function(){
		$('#mx-mask').css({
			'display':'block'
		})
	});
	$('#yes').click(function(){
		$('#mx-mask').css({
			'display':'none'
		})
		window.location.href = '#warp'
	});
	$('#no').click(function(){
		$('#mx-mask').css({
			'display':'none'
		})
	});
	 (function() {
        var agent = navigator.userAgent;
        if (/iphone|ipad|ipod/i.test(agent)) {
            $('body').addClass('ios'); 
        }else{
            $('.mx-an').removeClass('mx-mg-t60');
            $('.mx-an').addClass('mx-mg-t46');
            $('.slider-container_box').css('marginTop','4.9rem')
        }
      }());
	 var onDeviceReady = function onDeviceReady() {
    var network_id = "";
    var keys = [];
    var values = [];
    $.getJSON("flavor.json", function(json_data) {
        console.log(json_data)
        var ocuId = json_data.ocuId;
        var ocuSecret = json_data.ocuSecret;
        var appName = json_data.appName;
        var accessToken = json_data.appAccessToken;
        MXCommon.getServerUrl(function(serverUrl) {
            MXCommon.api({
                method:'get', //调用api请求的method:'get'/'post'
                url: "/api/v1/users?limit=5", //请求api的地址
                data:{
                    q:""
                 }
            }, //需要处理的https的headers
            function(data){
                console.log(data)
                var items = JSON.parse(data).items;
                for (var i = 0; i < $(".keys").length; i++) {
                    $(".keys:eq(" + i + ")").find("p").attr("data-id", items[i].login_name).html(items[i].name);
                }
            });
        })
        $("#commit").off("click.commit").on("click.commit", function() {

            var current_user_login_name = "";
            var network_id = "";
            MXCommon.getCurrentUser(function(d) {
                console.log(d)
                current_user_login_name = d.login_name;
                var user_id = d.id;
                MXContacts.selectUsers(function(a) {
                    console.log(a)
                    var _login_ids = new Array();
                    for (var i = 0; i < a.data.length; i++) {
                        _login_ids.push(a.data[i].id);
                    }
                    _login_ids.push(user_id);
                    var _login_ids_str = _login_ids.join(",") ;
                    $.sendOcuMessage(accessToken, ocuId, ocuSecret, _login_ids_str,user_id, [{
                        title: $("#title").val(),
                        description: "当前环节：办公室核稿<br>提交人：马青冈<br>提交时间：2015-1-25",
                        pic_url: "",
                        url: "launchApp://" + appName,
                        app_url: "launchApp://" + appName,
                        action_label: "办理"
                    }], function() {
                        alert("提交成功");
                        window.location.href = "#index"
                    },function(){
                        console.log(11111)
                    })

                }, false);
            });
        });
        $(".keys p").off("click.chat").on("click.chat",function(e) {
            e.preventDefault();
            var login_name = $(this).attr("data-id");
            //alert(login_name)
            var arr = new Array(login_name);
            //alert(JSON.stringify(MXChat.chat));
            //alert(JSON.stringify(MXCommon.getCurrentUser))
            MXChat.chat([login_name]);
        });
    });
};
document.addEventListener("deviceready", onDeviceReady, false);
</script>